<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Home</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <link href="css/cemetery.css" rel="stylesheet" />
    <style>
      .search-container {
        background-color: white;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      .nav-pills {
        border-bottom: 1px solid #dee2e6;
        padding-bottom: 10px;
        margin-bottom: 20px;
      }
      .nav-pills .nav-link {
        color: #6c757d;
        background-color: transparent;
        border: none;
        padding: 0.5rem 1rem;
        margin-right: 1rem;
        font-weight: 500;
      }
      .nav-pills .nav-link.active {
        color: #7749f8;
        background-color: transparent;
        border-bottom: 2px solid #7749f8;
        border-radius: 0;
      }
      .form-control {
        border-color: #ced4da;
      }
      .border_radius {
        border-radius: 20px;
        border: 2px solid var(--light-shade, #d4cdff);
        background: var(--white, #fff);
        box-shadow: 0px 4px 24px 0px rgba(151, 71, 255, 0.15);
      }
      .filter-container {
        display: flex;
        gap: 10px;
      }
      .filter-button {
        padding: 6px 12px;
        border: 1px solid #e0e0e0;
        border-radius: 20px;
        background-color: white;
        color: #333;
        font-size: 14px;
        display: flex;
        align-items: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .filter-button:hover {
        border-radius: 10px;
        border: 1px solid var(--gradient-CAT, #5702ff);
        background: var(--white, #fff);
      }
      .filter-button.active {
        background-color: #7749f8;
        border-color: #7749f8;
        color: white;
      }
      .filter-button .icon {
        margin-left: 5px;
      }
      .dropdown-icon::after {
        content: "\25BC";
        font-size: 10px;
        margin-left: 5px;
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->

    <div id="navbar-placeholder"></div>

    <!-- Navbar -->

    <!-- dearest search button with input start -->
    <div class="container mt-5">
      <div class="row justify-content-center">
        <div class="col-md-10">
          <div class="search-container">
            <ul class="nav nav-pills" id="pills-tab" role="tablist">
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link active"
                  id="pills-name-tab"
                  data-bs-toggle="pill"
                  data-bs-target="#pills-name"
                  type="button"
                  role="tab"
                  aria-controls="pills-name"
                  aria-selected="true"
                >
                  By name
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="pills-city-tab"
                  data-bs-toggle="pill"
                  data-bs-target="#pills-city"
                  type="button"
                  role="tab"
                  aria-controls="pills-city"
                  aria-selected="false"
                >
                  By city
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="pills-cemetery-tab"
                  data-bs-toggle="pill"
                  data-bs-target="#pills-cemetery"
                  type="button"
                  role="tab"
                  aria-controls="pills-cemetery"
                  aria-selected="false"
                >
                  By Cemetery
                </button>
              </li>
            </ul>
            <div class="tab-content" id="pills-tabContent">
              <div
                class="tab-pane fade show active"
                id="pills-name"
                role="tabpanel"
                aria-labelledby="pills-name-tab"
              >
                <form>
                  <div class="row g-3">
                    <div class="col-md-3">
                      <input
                        type="text"
                        class="form-control border_radius"
                        placeholder="First name"
                      />
                    </div>
                    <div class="col-md-3">
                      <input
                        type="text"
                        class="form-control border_radius"
                        placeholder="Middle name"
                      />
                    </div>
                    <div class="col-md-3">
                      <input
                        type="text"
                        class="form-control border_radius"
                        placeholder="Last name"
                      />
                    </div>
                    <div class="col-3 text-end">
                      <button
                        type="button"
                        class="btn btn-sm ms-1 dearest_search_btn"
                      >
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          width="24"
                          height="24"
                          viewBox="0 0 24 24"
                          fill="none"
                        >
                          <path
                            d="M17.5 17.5L22 22"
                            stroke="white"
                            stroke-width="1.5"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                          <path
                            d="M20 11C20 6.02944 15.9706 2 11 2C6.02944 2 2 6.02944 2 11C2 15.9706 6.02944 20 11 20C15.9706 20 20 15.9706 20 11Z"
                            stroke="white"
                            stroke-width="1.5"
                            stroke-linejoin="round"
                          />
                        </svg>
                        <b>Search </b>
                      </button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- dearest search button with input end -->

    <!-- dearest text with filter start here -->
    <div class="container">
      <div class="row dearest__row__1">
        <div class="col-md-6">
          <h3 class="dearest__h3">Cemetery</h3>
        </div>
        <div class="col-md-6 d-flex justify-content-end">
          <div class="filter-container">
            <button class="filter-button active">
              Short <span class="icon">â†‘</span>
            </button>
            <button class="filter-button">
              Short by: City <span class="dropdown-icon"></span>
            </button>
            <button class="filter-button">
              Short by: State <span class="dropdown-icon"></span>
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- dearest text with filter end here -->

    <!-- card section start here -->
    <div class="container">
      <div class="row deceased" id="organization-container">
        <!-- Cards will be inserted here dynamically -->
      </div>
    </div>

    <!-- card section end here -->

    <!--Footer section start-->

    <div id="footer-placeholder"></div>
    <!--Footer section end-->
    <script src="js/common.js"></script>
    <!--Footer section end-->
    <!-- Bootstrap JS and dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
    <!-- <script src="js/deceases.js"></script> -->
    <script src="url.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        console.log("Configuration loaded", window.config);
        updateCartCount();
      });
    </script>
    <script src="js/cart_common.js"></script>
    <script>
      // Cart functionality

      // Function to load the navbar HTML
      fetch("footer.html")
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("footer-placeholder").innerHTML = data;
        })
        .catch((error) => console.error("Error loading Footer:", error));

      document.addEventListener("DOMContentLoaded", function () {
        // Retrieve the access token from session storage
        const accessToken = sessionStorage.getItem("access_token");

        fetch(`${window.config.BACKEND_URL}/api/organizations/`, {
          method: "GET",
          headers: {
            Authorization: `Bearer ${accessToken}`, // Include the token in the request headers
          },
        })
          .then((response) => response.json())
          .then((data) => {
            const container = document.getElementById("organization-container");
            container.innerHTML = ""; // Clear any existing content

            data.forEach((org) => {
              const mapUrl = `https://www.google.com/maps/?q=${org.latitude},${org.longitude}`;

              const cardHTML = `
                <div class="col-12 col-sm-6 col-md-3 col-lg-3 mt-4">
                    <div class="card h-100" style="padding: 6px">
                        <div style="height: 240px; overflow: hidden">
                            <img class="card-img-top w-100 h-100"
                                src="${org.image}"
                                style="object-fit: cover"
                            />
                        </div>
                        <div class="card-body d-flex flex-column">
                            <h6 class="card-title">${org.name || ""}</h6>
                            <p class="card-text flex-grow-1">
                                ${org.description || ""}
                            </p>
                            <p>
                                <span class="product_dollar">$199</span> 
                                <span class="hero_section__shipping">One time fees</span>
                            </p>
                            <button
                                type="button"
                                class="btn btn-sm mt-auto dearest_search_btn"
                                onclick="window.location.href='${mapUrl}'"
                            >
                                <b>View on Map</b>
                            </button>
                        </div>
                    </div>
                </div>
            `;
              container.innerHTML += cardHTML;
            });
          })
          .catch((error) => console.error("Error fetching data:", error));
      });
    </script>
  </body>
</html>
